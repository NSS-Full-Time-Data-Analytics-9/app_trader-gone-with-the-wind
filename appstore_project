--purchase price = 10x cost or 25k
--each app earns 5k per month
--each app loses 1k per month for adverts regardless of if in one or both
--each .25 rating increase +life span 6mo starting with 1y at 0 rating
--preferred apps in both stores
--(48,000) x (1+(rounded rating*2) - (10,000 x price OR 25k)

-- 	a. Develop some general recommendations about the price range, genre, content rating, or any other app characteristics that the company should target.
-- price range
-- 	b. Develop a Top 10 List of the apps that App Trader should buy based on profitability/return on investment as the sole priority.
	SELECT p.name, a.name, a.primary_genre, p .genres, a.review_count, p.install_count, a.content_rating, p.content_rating,
	cast(round((p.rating+a.rating)*2,0)/4 as decimal(3,2)) as avg_rating, 
	ROUND((a.price + p.price::money::numeric)/2, 2) as avg_price
	 
	FROM app_store_apps as a
	INNER JOIN play_store_apps as p
	USING(name)
	WHERE cast(round((p.rating+a.rating)*2,0)/4 as decimal(3,2)) > 4
	AND ROUND((a.price + p.price::money::numeric)/2, 2) <= 2.50
	AND (a.review_count::numeric > 2000 or p.review_count::numeric > 2000)
	GROUP BY p.name, a.name, p.genres, a.primary_genre, p.rating, a.rating, p.price, a.price,a.review_count, p.install_count, a.content_rating, p.content_rating
	ORDER BY cast(round((p.rating+a.rating)*2,0)/4 as decimal(3,2)) desc
	limit 10
	
	
	SELECT *
	FROM play_store_apps
	
	

-- 	c. Develop a Top 4 list of the apps that App Trader should buy that are profitable but that also are thematically appropriate for V-DAY themed campaign.
	SELECT p.name, a.name, a.primary_genre, p .genres, a.review_count, p.install_count, a.content_rating, p.content_rating,
	CAST(round((p.rating+a.rating)*2,0)/4 AS decimal(3,2)) AS avg_rating, 
	ROUND((a.price + p.price::money::numeric)/2, 2) AS avg_price
	FROM app_store_apps AS a
	INNER JOIN play_store_apps as p
	USING(name)
	WHERE CAST(round((p.rating+a.rating)*2,0)/4 AS decimal(3,2)) > 3
	AND ROUND((a.price + p.price::money::numeric)/2, 2) <= 2.50
	AND (a.review_count::numeric > 1000 OR p.review_count::numeric > 1000)
	AND (genres ILIKE '%food%' or primary_genre ILIKE '%food%' 
				OR primary_genre ILIKE 'entertainment' OR genres ILIKE 'entertainment')
	GROUP BY p.name, a.name, p.genres, a.primary_genre, p.rating, a.rating, p.price, a.price,a.review_count, p.install_count, a.content_rating, p.content_rating
	ORDER BY cast(round((p.rating+a.rating)*2,0)/4 as decimal(3,2)) desc
	limit 5
	
-- 	D. Submit a report based on your findings. The report should include both of your lists of apps along with your analysis of their cost and potential profits. All analysis work must be done using PostgreSQL, however you may export query results to create charts in Excel for your report.

